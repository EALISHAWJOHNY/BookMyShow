-- Create Movie table
CREATE TABLE Movie (
    Id INT PRIMARY KEY IDENTITY(1,1),
    Name NVARCHAR(255) NOT NULL,
    ImdbRating DECIMAL(3, 1) NOT NULL,
    Category NVARCHAR(50) NOT NULL,
    Genre NVARCHAR(50) NOT NULL,
    ReleaseDate DATETIME NOT NULL,
    Duration int not Null,
    ActorName NVARCHAR(255),
    ActressName NVARCHAR(255),
    ThemePhotoPath NVARCHAR(255)
);

-- Create Theatre table
CREATE TABLE Theatre (
    Id INT PRIMARY KEY IDENTITY(1,1),
    Name NVARCHAR(255) NOT NULL,
    City NVARCHAR(50) NOT NULL
);

-- Create Show table
CREATE TABLE Show (
    Time NVARCHAR(50) NOT NULL,
    TheatreId INT NOT NULL,
    MovieId INT NOT NULL,
    FOREIGN KEY (TheatreId) REFERENCES Theatre(Id) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (MovieId) REFERENCES Movie(Id) ON UPDATE CASCADE ON DELETE CASCADE
);

-- Create Ticket table
CREATE TABLE Ticket (
    Id INT PRIMARY KEY IDENTITY(1,1),
    UserName NVARCHAR(255),
    NumberOfSeats INT,
    ShowTime NVARCHAR(50) NOT NULL,
    TheatreId INT NOT NULL,
    MovieId INT NOT NULL,
    FOREIGN KEY (ShowTime, TheatreId, MovieId) REFERENCES Show(Time, TheatreId, MovieId) ON UPDATE CASCADE ON DELETE SET NULL
);

-- Create Seat table
CREATE TABLE Seat (
    Number INT PRIMARY KEY IDENTITY(1,1),
    ShowTime NVARCHAR(50) NOT NULL,
    TheatreId INT NOT NULL,
    MovieId INT NOT NULL,
    TicketId INT,
    Availability NVARCHAR(50) NOT NULL,
    FOREIGN KEY (ShowTime, TheatreId, MovieId) REFERENCES Show(Time, TheatreId, MovieId) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (TicketId) REFERENCES Ticket(Id) ON UPDATE CASCADE ON DELETE SET NULL
);
-- Create ShowMovieModel table
CREATE TABLE ShowMovieModel (
Id int PRIMARY KEY IDENTITY(1,1),
    Time NVARCHAR(50) NOT NULL,
    TheatreId INT NOT NULL,
    MovieId INT NOT NULL,
    Name NVARCHAR(255) NOT NULL,
    FOREIGN KEY (TheatreId) REFERENCES Theatre(Id) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (MovieId) REFERENCES Movie(Id) ON UPDATE CASCADE ON DELETE CASCADE
);


-- Insert data into Movie table
INSERT INTO Movie (Id, Name, ImbdRating, Category, Genre, ReleaseDate, ActorName, ActressName, ThemePhotoPath) VALUES
(1, 'Inception', 8.8, 'Sci-Fi', 'Thriller', '2010-07-16', 'Leonardo DiCaprio', 'Ellen Page', 'path/to/inception.jpg'),
(2, 'The Dark Knight', 9.0, 'Action', 'Drama', '2008-07-18', 'Christian Bale', 'Maggie Gyllenhaal', 'path/to/darkknight.jpg');

-- Insert data into Theatre table
INSERT INTO Theatre (Id, Name, City) VALUES
(1, 'Regal Cinemas', 'New York'),
(2, 'AMC Theatres', 'Los Angeles');

-- Insert data into Show table
INSERT INTO Show (Time, TheatreId, MovieId) VALUES
('18:00', 1, 1),
('21:00', 1, 1),
('18:00', 2, 2),
('21:00', 2, 2);

-- Insert data into Ticket table
INSERT INTO Ticket (Id, UserName, NumberOfSeats, ShowTime, TheatreId, MovieId) VALUES
(1, 'JohnDoe', 2, '18:00', 1, 1),
(2, 'JaneSmith', 3, '21:00', 2, 2);

-- Insert data into Seat table
INSERT INTO Seat (Number, ShowTime, TheatreId, MovieId, TicketId, Availability) VALUES
(1, '18:00', 1, 1, 1, 'Booked'),
(2, '18:00', 1, 1, 1, 'Booked'),
(3, '18:00', 1, 1, NULL, 'Available'),
(4, '21:00', 2, 2, 2, 'Booked'),
(5, '21:00', 2, 2, 2, 'Booked'),
(6, '21:00', 2, 2, 2, 'Booked'),
(7, '21:00', 2, 2, NULL, 'Available');
